{
    "$schema": "../../node_modules/nx/schemas/project-schema.json",
    "name": "m4i-synchronize-app-search",
    "projectType": "application",
    "sourceRoot": "backend/m4i-synchronize-app-search/m4i_synchronize_app_search",
    "tags": [],
    "targets": {
        "docker-build": {
            "command": "docker buildx build . --build-arg PROJECT_DIR={projectRoot} --build-arg PYTHON_MODULE_NAME={args.moduleName} -f {args.file} -t {args.tag}",
            "dependsOn": ["load-jars", "build"],
            "metadata": {
                "description": "Build the Docker image for the application"
            },
            "options": {
                "env": {
                    "DOCKER_BUILDKIT": "1"
                },
                "file": "{workspaceRoot}/docker/aurelius-flink-base/Dockerfile",
                "moduleName": "m4i_synchronize_app_search",
                "tag": "{projectName}:local"
            }
        },
        "docker-publish": {
            "command": "docker buildx build . --build-arg PROJECT_DIR={projectRoot} --build-arg PYTHON_MODULE_NAME={args.moduleName} -f {args.file} -t {args.namespace}/{projectName}:{args.version} --push",
            "dependsOn": [{ "target": "build" }],
            "metadata": {
                "description": "Publish the Docker image for the application"
            },
            "options": {
                "env": {
                    "DOCKER_BUILDKIT": "1"
                },
                "file": "{workspaceRoot}/docker/aurelius-flink-base/Dockerfile",
                "moduleName": "m4i_synchronize_app_search",
                "namespace": "ghcr.io/aureliusenterprise",
                "version": "latest"
            }
        },
        "load-jars": {
            "command": "bash {projectRoot}/jars/load-jars.sh"
        }
    }
}
